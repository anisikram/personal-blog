---
import cvData from '../data/cv.json';

function formatDate(dateString) {
  if (!dateString) return 'Présent';
  const date = new Date(dateString);
  return date.toLocaleDateString('fr-FR', { year: 'numeric', month: 'short' });
}
---

<div class="card bg-base-100 shadow-xl p-6">
  <h2 class="text-2xl font-bold mb-8 text-center">Expérience Professionnelle</h2>
  <ul class="timeline timeline-vertical">
    {cvData.map((experience, index) => (
      <li>
        {index > 0 && <hr />}
        <div class={`timeline-${index % 2 === 0 ? 'start' : 'end'} timeline-box`}>
          <h3 class="text-xl font-semibold">{experience.title}</h3>
          <p class="text-lg text-primary">{experience.company}</p>
          <p class="text-sm text-gray-500 mb-2">
            {formatDate(experience.startDate)} - {formatDate(experience.endDate)}
          </p>
          <ul class="list-disc list-inside text-sm">
            {experience.description.map(item => (
              <li>{item}</li>
            ))}
          </ul>
          <div class="mt-3 flex flex-wrap gap-2">
            {experience.technologies.map(tech => (
              <span class="badge badge-outline">{tech}</span>
            ))}
          </div>
        </div>
        <div class="timeline-middle">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" /></svg>
        </div>
        {index < cvData.length - 1 && <hr />}
      </li>
    ))}
  </ul>
</div>